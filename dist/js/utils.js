const init=()=>{const e=document.querySelectorAll('button[name="submit"]');for(let t of e)t.onclick=submitForm;const t=document.getElementById("js-signup-email"),o=document.getElementById("js-signup-phone");t.onclick=showElem,o.onclick=showElem};init();const getSelectedCurrency=e=>document.querySelector(`#${e}-content select[name="currency"]`).value,getEmail=e=>document.querySelector(`#${e}-content input[name="email"]`).value,getPhonenumber=e=>document.querySelector(`#${e}-content input[name="phone"]`).value,getPromoCheckbox=e=>document.querySelector(`#${e}-content input[name="promoCheckbox"]`).checked,getTermsCheckbox=e=>document.querySelector(`#${e}-content input[name="termsCheckbox"]`).checked,getErrors=e=>{return(e.error?e.error.details:[]).map(e=>({field:e.path[0],text:e.message}))},resetErrorMessages=()=>{errorElem=document.querySelectorAll('span[name="error"]'),errorElem.forEach(function(e){e.remove()})},showErrors=(e,t)=>{const o=document.querySelector(`#${t}-content form`);e.forEach(e=>{const t=o.querySelector(`[name=${e.field}]`),r=document.createElement("span");r.classList.add("error"),r.setAttribute("name","error"),r.innerHTML=e.text,t.parentNode.parentNode.insertBefore(r,t.parentNode.nextSibling)})},showSpinner=e=>{document.querySelector("div .spinner").style.display="block",e.querySelector("fieldset").classList.add("form__fieldset--opacity")},hideSpinner=e=>{document.querySelector("div .spinner").style.display="none",e.querySelector("fieldset").classList.remove("form__fieldset--opacity")},showMessage=(e,t)=>{document.getElementById("signup-message")&&document.getElementById("signup-message").remove();const o=["Thank you! Your user registration was successful.","You can login anytime now."],r=["Registration is temporarily unavailable.","Please try again later."],n=document.createElement("div");n.classList.add(`signup-message--${t?"success":"error"}`),n.setAttribute("id","signup-message");const s=document.createElement("h6"),i=document.createElement("p"),a=document.createTextNode(t?o[0]:r[0]),c=document.createTextNode(t?o[1]:r[1]);s.appendChild(a),i.appendChild(c),n.appendChild(s),n.appendChild(i),e.closest("form").appendChild(n)},validations=e=>{if("email"===e){let t={email:getEmail(e),currency:getSelectedCurrency(e),promoCheckbox:getPromoCheckbox(e),termsCheckbox:getTermsCheckbox(e)};return joi.object({email:joi.string().min(3).max(30).email({tlds:{allow:!1}}).required().messages({"string.base":"Email should be a type of 'text'","string.empty":"Email cannot be an empty field","string.email":"Email is not valid","string.min":"Email should have a minimum length of {#limit}","string.max":"Email should have a maximum length of {#limit}","any.required":"Email is a required field"}),currency:joi.string().required().messages({"string.empty":"Please select currency","any.required":"Currency is a required field"}),promoCheckbox:joi.boolean().optional().allow(!1),termsCheckbox:joi.boolean().valid(!0).messages({"any.only":"You must confirm Terms and Conditions"})}).options({abortEarly:!1}).validate(t)}if("phone"===e){let t={phone:getPhonenumber(e),currency:getSelectedCurrency(e),promoCheckbox:getPromoCheckbox(e),termsCheckbox:getTermsCheckbox(e)};return joi.object({phone:joi.string().pattern(new RegExp("^\\+\\d{3}\\s?\\d{2}\\s?\\d{3}\\s?\\d{3,4}$")).required().messages({"string.empty":"Phone number cannot be an empty field","any.required":"Phone number is a required field","string.pattern.base":"Please enter your phone number in this format +XXX XX XXX XXXX"}),currency:joi.string().required().messages({"string.empty":"Please select currency","any.required":"Currency is a required field"}),promoCheckbox:joi.boolean().optional().allow(!1),termsCheckbox:joi.boolean().valid(!0).messages({"any.only":"You must confirm Terms and Conditions"})}).options({abortEarly:!1}).validate(t)}};function submitForm(e){resetErrorMessages();const t=e.target,o=t.closest("section"),r=o.getAttribute("data-section"),n=validations(r),s=getErrors(n);s&&s.length?showErrors(s,r):(showSpinner(o),setTimeout(function(){hideSpinner(o);const e=Math.random()>.5;showMessage(t,e)},1500))}function showElem(e){const t=e.target.getAttribute("data-select-section"),o=document.getElementsByTagName("a");for(let e of o)e.getAttribute("data-select-section")===t?e.classList.add("active"):e.classList.remove("active");const r=document.querySelectorAll("#js-signup-form section");for(let e of r)e.getAttribute("data-section")===t?e.style.display="block":e.style.display="none"}